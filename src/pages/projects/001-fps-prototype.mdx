---
blurb: "Built with Unreal Engine 5"
draft: false
layout: ../../layouts/ProjectLayout.astro
image: /images/projects/fps-prototype/cover.png
title: "First-Person Shooter Prototype"
---

<div class="flexbox-vertical note">
  An FPS prototype featuring a variety of playable characters, weapons, and abilities. Built from scratch in Unreal Engine 5 using C++ and Blueprints along with:
  
  - Unreal Engine Gameplay Ability System (GAS)
  - Unreal Engine Common UI
  - Behavior trees for enemy and companion AI
</div>

<iframe class="yt-iframe" style="margin-inline: auto;" width="560" height="315" src="https://www.youtube-nocookie.com/embed/OZTmzO1LTjY?si=gX94T3WKu9WJXaft" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

## Overview

Inspired by the story-driven campaigns of games like _Titanfall 2_ and _Uncharted_, the weapon systems of games like _Halo_ and _Call of Duty_, and the companion mechanics of games like _Mass Effect_ and _Gears of War_, I created this project to practice the design and implementation of various interconnecting game systems and mechanics.

<div class="flexbox-vertical note">
  # Asset Credits

  To speed up development and allow myself to focus on design and coding, I utilized premade assets from these sources:
  
  - **Static models:** <a class="text-link" href="https://www.unrealengine.com/marketplace/en-US/product/polygon-megapolis-city-pack" target="_blank">POLY - Megapolis City Pack</a> by Animpic Studio
  - **Character models:** <a class="text-link" href="https://www.mixamo.com/#/" target="_blank">Mixamo</a>, Unreal Engine template projects
  - **Animations:** <a class="text-link" href="https://www.mixamo.com/#/" target="_blank">Mixamo</a>, <a class="text-link" href="https://www.unrealengine.com/marketplace/en-US/item/3319a35b40444bb69022d96f375b83de" target="_blank">Mobility Basic</a> / <a class="text-link" href="https://www.unrealengine.com/marketplace/en-US/item/4ae8e3175c094904be9ec2cea04ccb8c" target="_blank">Boxing</a> / <a class="text-link" href="https://www.unrealengine.com/marketplace/en-US/item/2de28b7ceeb846d8bd417e2e6d7fcb22" target="_blank">Pistol Basic</a> / <a class="text-link" href="https://www.unrealengine.com/marketplace/en-US/item/111a3cf0b5bf429eb0c83d7d99c3b2b5" target="_blank">Rifle Basic</a> / <a class="text-link" href="https://www.unrealengine.com/marketplace/en-US/item/cbe760bcc55d4936b663c2bab7d090ae" target="_blank">Death</a> MoCap Packs by MoCap Online
  - **SFX:** <a class="text-link" href="https://www.unrealengine.com/marketplace/en-US/item/f6f88552c30e42b3a7ceeb2c638c66fa" target="_blank">Pro Sound Collection</a> by Gamemaster Audio, <a class="text-link" href="https://www.unrealengine.com/marketplace/en-US/item/a1819d9abdbc4d9d801b44fcff7394ff" target="_blank">Sci Fi Guns Sounds Pack</a> by Daydream Sound
  - **VFX:** <a class="text-link" href="https://www.unrealengine.com/marketplace/en-US/item/edea928b71974a3f8b8f08829b49b3aa" target="_blank">VFX Pack - Stylized FPS Muzzle and Impacts Effects</a> by BlueSlothVFX
</div>

## Controls

Using Unreal Engine’s **Enhanced Input** system, the game’s controls are implemented for both gamepads and mouse/keyboard. In designing this control scheme, my goal was to support a wide variety of actions while keeping the controls as simple and intuitive as possible.

### Gamepad Controls

<img alt="A diagram of a video game control scheme overlaid on top of a photo of an Xbox controller" src="/images/projects/fps-prototype/controls-gamepad.png" width="600" />

### Mouse/Keyboard Controls

<div class="flexbox-horizontal flexbox-horizontal-blocks">

| Input | Action |
| -------- | ------- |
| **W/A/S/D** | Walk/Run |
| **Shift** | Sprint |
| **Mouse-X/Y** | Adjust Camera |
| **X** | Melee Attack |
| **Spacebar** | Jump |
| **C** | Crouch |
| **E** | Interact |
| **R (tap)** | Reload |
| **R (hold)** | Open Special Ability Wheel |
| **Escape** | Pause Game |

| Input | Action |
| -------- | ------- |
| **RMB** | Aim Down Sights |
| **RMB + F** | Aim Grenade |
| **Command** | Special Ability |
| **LMB** | Fire Weapon/Throw Grenade |
| **1** | Switch to Squad Member 1 |
| **2** | Switch to Squad Member 2 |
| **3** | Primary Weapon |
| **4** | Secondary Weapon |
| **5 (tap)** | Quick Info |
| **5 (hold)** | Switch Camera Mode |

</div>

## Camera

Although the game is designed to be an FPS, I wanted to practice working with different camera systems, so I implemented a camera that can switch between **first-person and third-person (over-the-shoulder) modes**.

<iframe class="yt-iframe" width="560" height="315" src="https://www.youtube-nocookie.com/embed/vuDTP0blgtA?si=jrElcXxS3jBrVRyH" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

To support multiple camera perspectives, I used separate first-person and third-person skeletal meshes for each playable character. I shared animations between these meshes by creating an **IK Retargeter** for each unique skeleton in Unreal Engine and retargeting animations between them.

<img alt="A screenshot of an IK Retargeter in Unreal Engine showcasing two different skeletal meshes arranged in similar T-poses." src="/images/projects/fps-prototype/ik-retargeting.png" width="600" />

I used a variety of techniques inside an **Animation Blueprint** to implement smooth animation transitions for each skeleton, including animation state machines, blended poses, Blend Spaces, and Aim Offsets.

<div class="flexbox-horizontal flexbox-horizontal-blocks" style="margin-block-end: var(--spacing-6);">
  <img alt="A screenshot of an Animation Blueprint inside Unreal Engine" class="flex-grow-1" src="/images/projects/fps-prototype/animation-blueprint-1.png" width="400" />

  <img alt="A screenshot of an Animation Blueprint inside Unreal Engine" class="flex-grow-1" src="/images/projects/fps-prototype/animation-blueprint-2.png" width="400" />
</div>

## Scripting

I built a system that allows for triggering scripted events within a level in a data-driven way.

<img alt="A screenshot of an Unreal Engine Data Table filled with scripted events" src="/images/projects/fps-prototype/scripting-data-table.png" />

<iframe class="yt-iframe" width="560" height="315" src="https://www.youtube-nocookie.com/embed/7qFSqtya-90?si=qbDhqvzfr5bLSQfr" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

**NPC barks** can be triggered, which utilize Dialogue Waves to play audio (in this prototype, placeholder audio is used in lieu of recorded dialogue). Barks can trigger other barks, allowing NPCs to respond to each other.

<img alt="An animated GIF of video game dialogue subtitles" src="/images/projects/fps-prototype/barks-1.gif" />

Scripted behaviors for NPCs can be triggered, such as gesture animations and targeted movement.

<div class="flexbox-horizontal flexbox-horizontal-blocks" style="margin-block-end: var(--spacing-6);">
  <img alt="An animated GIF of a video game character turning and pointing in the distance" src="/images/projects/fps-prototype/scripted-turn.gif" />

  <img alt="An animated GIF of a video game character nodding" src="/images/projects/fps-prototype/scripted-nod.gif" />
</div>

**Mission objectives and tutorials** can be triggered and displayed in the HUD.

<img alt="An animated GIF of a video game tutorial notification being shown and then hidden" src="/images/projects/fps-prototype/scripted-tutorial.gif" />

<img alt="An animated GIF of a video game mission objective notification being shown and then hidden" src="/images/projects/fps-prototype/scripted-objective.gif" />

Temporary player view targets can be triggered, which prompt the player to press a button to pan the camera in a certain direction and gain visual context on their objective.

<iframe class="yt-iframe" width="560" height="315" src="https://www.youtube-nocookie.com/embed/CGZlfKYYqhI?si=hNpzgo2Xz8y13jDw" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

## Companion AI

Companion logic is implemented in a **Behavior Tree**.

Companions can be targeted at a particular location, encouraging the player to follow them.

<iframe class="yt-iframe" width="560" height="315" src="https://www.youtube-nocookie.com/embed/zb8uyFebxm0?si=lwLWdDweA780DcgF" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

When not in combat and not targeted at a location, companions will generally follow the player.

**Nav Link Proxies** are used to bridge separated areas within the level’s **Navigation Mesh**. Companions will use these links to follow the player, performing relevant movements like opening doors and mantling onto objects along the way.

<iframe class="yt-iframe" width="560" height="315" src="https://www.youtube-nocookie.com/embed/EZPZP2ngfJ4?si=tBUMk8BQXRZ_nfns" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

To avoid impeding the player’s movement, companions will move out of the way if the player bumps into them. This behavior uses **Environment Query System (EQS)** queries to find a reasonable nearby location for the NPC to go.

<iframe class="yt-iframe" width="560" height="315" src="https://www.youtube-nocookie.com/embed/as1_ba3wwaM?si=eLCEgWn5NF-Bqw4T" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

## Enemy AI

Enemy logic is implemented in a **Behavior Tree**.

Enemies not engaged in combat can be posted at a particular location or walk along a patrol route.

<iframe class="yt-iframe" width="560" height="315" src="https://www.youtube-nocookie.com/embed/6kzootqcjvA?si=u8FnMUf1tRjjXZkA" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

Through an AI Perception Component, enemies can detect when the player is nearby.

When the player first enters an enemy’s sight line, the enemy turns toward the player and plays an audio bark to indicate that the player has been spotted. If other enemies are nearby, they will also be alerted to the player’s presence (this is accomplished through an **instance-synced Blackboard key** that is shared across related enemies).

Enemy combat behavior is implemented using **Environment Query System (EQS)** queries. Enemies attack the nearest player or companion while maintaining a minimum distance and preferring to attack from behind cover. Enemies will also switch between weapons depending on their distance from their target.

<iframe class="yt-iframe" width="560" height="315" src="https://www.youtube-nocookie.com/embed/QYul8AI2-ZM?si=JuMRpT8HRGlWHePV" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

## Gameplay Abilities

Most significant actions in the game are implemented using Unreal Engine’s **Gameplay Ability System (GAS)**. Using GAS allowed me to not only tap into a robust system of activation, blocking, and cancellation capabilities, but to do so in a clean and organized way.

### Sprinting

I integrated GAS cost and cooldown capabilities with sprinting to build a **stamina regeneration** mechanic. How much stamina a character has, how quickly it is depleted, and the rate at which it regenerates can all be configured through gameplay attributes.

<iframe class="yt-iframe" width="560" height="315" src="https://www.youtube-nocookie.com/embed/kXXaiM-HnN8?si=DCpwGBlKH47MJQLM" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<img alt="An animated GIF of a video game stamina bar emptying and refilling" src="/images/projects/fps-prototype/stamina-bar.gif" />

### Character Switching

In this prototype, I wanted to be able to play with a variety of character types and weapons, so I implemented a system in which **every companion is also a playable character**.

When the player switches between characters, C++ code executes teardown logic on the departing character to prepare it for AI control (switching from a first-person mesh to a third-person mesh, starting Behavior Tree logic, etc.). Similarly, setup logic is executed on the incoming character to prep it for player control.

<iframe class="yt-iframe" width="560" height="315" src="https://www.youtube-nocookie.com/embed/rhW03YSgNO0?si=5BUybbGkcZ0raTws" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

<iframe class="yt-iframe" width="560" height="315" src="https://www.youtube-nocookie.com/embed/7R0Z24jdQD8?si=qpH18UMe3xzqW9ZT" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

### Melee Attacks

During a melee attack, an Animation Montage is played, which triggers a Notify State that creates and then destroys a **hitbox**. Hostile characters that overlap with this hitbox play a hit reaction animation and are dealt damage.

<iframe class="yt-iframe" width="560" height="315" src="https://www.youtube-nocookie.com/embed/MDrpjXvMAmo?si=Yquc7GM76XjEKts0" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

Since shooting is the main form of combat in this prototype, I kept the melee system simple. In a more complex melee combat system, unique attacks could be designed to use hitboxes of different sizes, shapes, and placements. Systems like soft locking could also be implemented using **motion warping** to aid the player’s accuracy.

### Special Abilities

Although they aren’t fully fleshed out yet, I implemented a few different special abilities as a proof of concept. Special abilities can add variety and depth to combat by giving the player options other than just shooting.

<iframe class="yt-iframe" width="560" height="315" src="https://www.youtube-nocookie.com/embed/6sDAU3zNJu0?si=WIfT-ZR_WMz_Y5_-" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

## Shooting

The three types of guns in this prototype—pistols, assault rifles, and shotguns—are implemented as **hitscan** weapons.

Shooting is implemented as a GAS **gameplay ability**. The ability code performs various line traces and calculations to execute each shot along with triggering relevant animations, SFX, VFX, hit reactions, and damage gameplay effects. It utilizes GAS costs to consume weapon ammo and GAS cooldowns to enforce a maximum rate of fire.

### Spread

To implement spread, a bullet’s trajectory is **randomized within a cone originating from the gun’s muzzle**. The cone’s diameter could be calculated using gameplay attributes and other factors such as whether the character is running or standing still.

<iframe class="yt-iframe" width="560" height="315" src="https://www.youtube-nocookie.com/embed/oD37mNZH0mw?si=eJYRh3zE43hgbZ0k" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

Weapons like shotguns can be configured to fire multiple projectiles at once.

<img alt="A screenshot of a video game shotgun with debugging markings illustrating the trajectory of the gun's projectiles" src="/images/projects/fps-prototype/spread-sg.png" width="600" />

### Recoil

After firing a weapon, **viewkick** is temporarily added to the viewport to simulate recoil. The direction, severity, and rate of recovery (**centerspeed**) of the viewkick could be configured for each unique weapon, allowing for a variety of differentiated weapon designs.

<iframe class="yt-iframe" width="560" height="315" src="https://www.youtube-nocookie.com/embed/JnvtgSWvjII?si=Kv2tbgPqbJy14TB-" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

## UI

The HUD displays key pieces of information related to the player’s vital stats, squad, weapons, and special abilities.

<img alt="A screenshot of a video game HUD (heads-up display) UI" src="/images/projects/fps-prototype/hud.png" width="900" />

Thanks to Unreal Engine’s **Common UI** plugin, the game’s UI can dynamically display gamepad and mouse/keyboard icons depending on what type of controller the player is using.

[PICS TODO]

The game’s main menu supports three levels of tabbing. It utilizes Common UI widgets like tab lists, carousels, and activatable widget switchers.

<iframe class="yt-iframe" width="560" height="315" src="https://www.youtube-nocookie.com/embed/0AAMr3gCx-c?si=4J8jjcwi1ivpOxQw" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>

The HUD can display temporary UI components like notifications and info displays. These components use C++ timers and queues to display information at the right time.

[PICS TODO]
